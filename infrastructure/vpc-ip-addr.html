<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VPCs &amp; IP Addressing | AS Cloud Docs</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link href="https://common.northwestern.edu/v8/icons/favicon-16.png" rel="icon" sizes="16x16" type="image/png">
    <link href="https://common.northwestern.edu/v8/icons/favicon-32.png" rel="icon" sizes="32x32" type="image/png">
    <meta name="description" content="Docs for Northwestern IT staff on our cloud implementation.">
    
    <link rel="preload" href="/AS-CloudDocs/assets/css/0.styles.425dfd68.css" as="style"><link rel="preload" href="/AS-CloudDocs/assets/js/app.9e8c026c.js" as="script"><link rel="preload" href="/AS-CloudDocs/assets/js/2.1981cd55.js" as="script"><link rel="preload" href="/AS-CloudDocs/assets/js/48.a0e2ec9e.js" as="script"><link rel="prefetch" href="/AS-CloudDocs/assets/js/10.817e36c9.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/11.3f6da0b0.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/12.47e84d50.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/13.9214e9be.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/14.ba329726.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/15.b322c67e.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/16.63d867c1.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/17.efbe6606.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/18.08a1d6c6.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/19.9e2348f7.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/20.1bab3fb9.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/21.f66ab42a.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/22.7908c566.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/23.c0cdf4ed.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/24.6cde5c32.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/25.2e3b8486.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/26.a0da6c32.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/27.5d75500c.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/28.c1a33562.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/29.e1e6744f.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/3.fea76ffe.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/30.2652e855.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/31.e737a602.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/32.b43eac73.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/33.69463bcb.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/34.7bbea69d.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/35.255fd512.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/36.47616b19.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/37.0271a862.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/38.58da5b62.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/39.6ae82d62.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/4.fd8a9d0a.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/40.1b21cab9.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/41.d06ac9c6.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/42.0cf37b60.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/43.3cfc71df.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/44.08927194.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/45.f313f02b.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/46.06513cd5.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/47.adaa6241.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/49.91d80233.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/5.f8165a6e.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/50.f6a459b5.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/51.723e0004.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/6.1f42bd9f.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/7.47c3d4b9.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/8.f718a08e.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/9.24df5b62.js">
    <link rel="stylesheet" href="/AS-CloudDocs/assets/css/0.styles.425dfd68.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/AS-CloudDocs/" class="home-link router-link-active"><!----> <span class="site-name">AS Cloud Docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/NIT-Administrative-Systems/AS-CloudDocs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/NIT-Administrative-Systems/AS-CloudDocs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Introduction</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AS-CloudDocs/" aria-current="page" class="sidebar-link">Overview</a></li><li><a href="/AS-CloudDocs/roles-responsibilities.html" class="sidebar-link">Roles &amp; Responsibilities</a></li><li><a href="/AS-CloudDocs/design-for-cloud.html" class="sidebar-link">Designing Apps for the Cloud</a></li><li><a href="/AS-CloudDocs/tools.html" class="sidebar-link">Tool Recommendations</a></li><li><a href="/AS-CloudDocs/docs-site.html" class="sidebar-link">Documentation Site</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Infrastructure</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AS-CloudDocs/infrastructure/aws-account-design.html" class="sidebar-link">AWS Account Structure</a></li><li><a href="/AS-CloudDocs/infrastructure/tagging.html" class="sidebar-link">Tagging Resources</a></li><li><a href="/AS-CloudDocs/infrastructure/vpc-ip-addr.html" aria-current="page" class="active sidebar-link">VPCs &amp; IP Addressing</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/AS-CloudDocs/infrastructure/vpc-ip-addr.html#assignment" class="sidebar-link">Assignment</a></li><li class="sidebar-sub-header"><a href="/AS-CloudDocs/infrastructure/vpc-ip-addr.html#using-subnets" class="sidebar-link">Using Subnets</a></li></ul></li><li><a href="/AS-CloudDocs/infrastructure/alb.html" class="sidebar-link">Application Load Balancers</a></li><li><a href="/AS-CloudDocs/infrastructure/certificates.html" class="sidebar-link">Certificates</a></li><li><a href="/AS-CloudDocs/infrastructure/api-gateway.html" class="sidebar-link">API Gateway</a></li><li><a href="/AS-CloudDocs/infrastructure/lambda.html" class="sidebar-link">Lambda</a></li><li><a href="/AS-CloudDocs/infrastructure/ecs-fargate.html" class="sidebar-link">Fargate for ECS</a></li><li><a href="/AS-CloudDocs/infrastructure/ses.html" class="sidebar-link">Simple Email Service (SES)</a></li><li><a href="/AS-CloudDocs/infrastructure/iam.html" class="sidebar-link">Identity &amp; Access Management (IAM)</a></li><li><a href="/AS-CloudDocs/infrastructure/databases.html" class="sidebar-link">Databases</a></li><li><a href="/AS-CloudDocs/infrastructure/secrets.html" class="sidebar-link">Secret Management</a></li><li><a href="/AS-CloudDocs/infrastructure/alerts.html" class="sidebar-link">Alerts</a></li><li><a href="/AS-CloudDocs/infrastructure/cloudfront.html" class="sidebar-link">CloudFront CDN</a></li><li><a href="/AS-CloudDocs/infrastructure/vapor.html" class="sidebar-link">Laravel Vapor</a></li><li><a href="/AS-CloudDocs/infrastructure/aws-service-scheduler.html" class="sidebar-link">AWS Service Scheduler</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Infrastructure as Code</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AS-CloudDocs/iac/terraform-concepts.html" class="sidebar-link">Terraform</a></li><li><a href="/AS-CloudDocs/iac/as-tf-modules.html" class="sidebar-link">AS Terraform Modules</a></li><li><a href="/AS-CloudDocs/iac/example-tf.html" class="sidebar-link">Example Terraform Module</a></li><li><a href="/AS-CloudDocs/iac/available-modules.html" class="sidebar-link">Available Modules</a></li><li><a href="/AS-CloudDocs/iac/state-buckets.html" class="sidebar-link">State Bucket Reference</a></li><li><a href="/AS-CloudDocs/iac/tf-import.html" class="sidebar-link">Terraform Import</a></li><li><a href="/AS-CloudDocs/iac/tf-move.html" class="sidebar-link">Terraform State Move</a></li><li><a href="/AS-CloudDocs/iac/tf-upgrading.html" class="sidebar-link">Upgrading Terraform</a></li><li><a href="/AS-CloudDocs/iac/faq.html" class="sidebar-link">Frequently Asked Questions</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>CI &amp; CD</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AS-CloudDocs/ci-cd/jenkins.html" class="sidebar-link">Jenkins Pipelines</a></li><li><a href="/AS-CloudDocs/ci-cd/shared-libs.html" class="sidebar-link">Shared Library</a></li><li><a href="/AS-CloudDocs/ci-cd/jenkins-ecs-agent.html" class="sidebar-link">Jenkins ECS Agent</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Application Development</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AS-CloudDocs/development/principles.html" class="sidebar-link">Design Principles</a></li><li><a href="/AS-CloudDocs/development/app-patterns.html" class="sidebar-link">Application Patterns</a></li><li><a href="/AS-CloudDocs/development/laravel-stack.html" class="sidebar-link">Laravel Stack</a></li><li><a href="/AS-CloudDocs/development/express-stack.html" class="sidebar-link">ExpressJS Stack</a></li><li><a href="/AS-CloudDocs/development/spring-stack.html" class="sidebar-link">Spring Stack</a></li><li><a href="/AS-CloudDocs/development/frontend-stacks.html" class="sidebar-link">Frontend Stacks</a></li><li><a href="/AS-CloudDocs/development/libraries.html" class="sidebar-link">Packages &amp; Libraries</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Security</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AS-CloudDocs/security/sso-approaches.html" class="sidebar-link">Single Sign-on</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>GitHub</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AS-CloudDocs/github/settings-permissions.html" class="sidebar-link">Settings &amp; Permissions</a></li><li><a href="/AS-CloudDocs/github/repo-layout.html" class="sidebar-link">Repository Structure</a></li><li><a href="/AS-CloudDocs/github/workflow.html" class="sidebar-link">Workflow</a></li><li><a href="/AS-CloudDocs/github/policies.html" class="sidebar-link">Policy</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vpcs-ip-addressing"><a href="#vpcs-ip-addressing" class="header-anchor">#</a> VPCs &amp; IP Addressing</h1> <p>As mentioned in the <a href="/AS-CloudDocs/infrastructure/aws-account-design.html">AWS account design</a> article, each account will have a Virtual Private Cloud (VPC) with a large block of Northwestern LAN IPs assigned to it. These addresses can route back to the campus datacenters by way of a VPN.</p> <p>If you wish to run an application inside the VPC, you will need to be assigned a subnet. This is a smaller slice of the VPC's total IP pool. Depending on the application, you may be given shared subnets or a dedicated app-specific subnets. EC2s, ECS containers, Lambdas, and any AWS service utilizing these compute services can be provided with a VPC ID &amp; subnet IDs.</p> <p>You will typically receive a pair of subnet IDs, with each subnet being configured to exist in a different availability zone.</p> <h2 id="assignment"><a href="#assignment" class="header-anchor">#</a> Assignment</h2> <p>Your VPC has a limited amount of IP space on the Northwestern network. This resource is managed by the EACD-CloudOps group, so you should ask them for an appropriate subnet for your application.</p> <p>Subnet assignments are done in your account's shared resources Github repository as infrastructure-as-code.</p> <p>In cases where you are certain that you do not need to access resources in the campus datacenter, you do not need a subnet allocation -- Amazon can provide the IPs from their pool of public addresses.</p> <h3 id="considerations"><a href="#considerations" class="header-anchor">#</a> Considerations</h3> <p>Each AWS account has a pair of &quot;general use&quot; subnets, generally labelled Pvt-AZ1/Pvt-AZ2 and Pub-AZ1/Pub-AZ2. You can make use of these if you are not concerned about firewalls or IP whitelisting to allow your application access to on-campus resources.</p> <p>If you wanted a service on AWS to access an Oracle DB in the datacenter, you would likely want a dedicated subnet for your application. Then, this subnet could be permitted access to the Oracle server without granting any other apps access.</p> <p>We do not give you a single IP address in a subnet. All firewall rules should be done for the assigned subnets (usually two; one per availability zone). Lambdas may use any IP from the subnet at any point, and EC2 or ECS machines will change addresses as you deploy new versions of your application (as you usually create a new instance before tearing down the old one).</p> <h3 id="assignment-process"><a href="#assignment-process" class="header-anchor">#</a> Assignment Process</h3> <p>The EACD-CloudOps group will evaluate your request and determine if you need a dedicated subnet for your application, or if you can use an existing shared subnet. Factors such as application isolation and concurrent compute resource are considered.</p> <p>A <a href="http://www.davidc.net/sites/default/subnets/subnets.html" target="_blank" rel="noopener noreferrer">subnetting tool<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> will help determine how to split remaining IP space up. Amazon only allows us to split subnets as small as a /28. An entry will be added to your account's shared resource IaC and the subnet will be provisioned.</p> <p>If all available IP space is exhausted, the PIPS-CloudOps group will be engaged. They will work with TNS to add additional subnet(s) to the VPC.</p> <h2 id="using-subnets"><a href="#using-subnets" class="header-anchor">#</a> Using Subnets</h2> <p>To use subnets in your IaC modules, you will want to create a <a href="/AS-CloudDocs/iac/as-tf-modules.html">remote resource to load the tfstate</a> from your shared account resources module. The remote resource will make the subnet IDs available for use.</p> <div class="language-hcl extra-class"><pre class="language-hcl"><code><span class="token keyword">data <span class="token type variable">&quot;terraform_remote_state&quot;</span></span> <span class="token string">&quot;account_resources&quot;</span> <span class="token punctuation">{</span>
  <span class="token property">backend</span> <span class="token punctuation">=</span> <span class="token string">&quot;s3&quot;</span>

  <span class="token property">config</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
    <span class="token property">bucket</span> <span class="token punctuation">=</span> var.account_resources_state_bucket
    <span class="token property">key</span>    <span class="token punctuation">=</span> var.account_resources_state_file
    <span class="token property">region</span> <span class="token punctuation">=</span> var.account_resources_state_region
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">resource <span class="token type variable">&quot;aws_ecs_service&quot;</span></span> <span class="token string">&quot;ecs_task_serv&quot;</span> <span class="token punctuation">{</span>
    <span class="token property">name</span> <span class="token punctuation">=</span> local.ecs_task_name
    
    <span class="token comment">// . . .</span>

    <span class="token keyword">network_configuration</span> <span class="token punctuation">{</span>
        <span class="token property">subnets</span> <span class="token punctuation">=</span> data.terraform_remote_state.account_resources.docconv_subnets
        <span class="token comment">// . . .</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/NIT-Administrative-Systems/AS-CloudDocs/edit/stable/infrastructure/vpc-ip-addr.md" target="_blank" rel="noopener noreferrer">Edit Page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">1/14/2022, 4:36:39 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/AS-CloudDocs/infrastructure/tagging.html" class="prev">
        Tagging Resources
      </a></span> <span class="next"><a href="/AS-CloudDocs/infrastructure/alb.html">
        Application Load Balancers
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/AS-CloudDocs/assets/js/app.9e8c026c.js" defer></script><script src="/AS-CloudDocs/assets/js/2.1981cd55.js" defer></script><script src="/AS-CloudDocs/assets/js/48.a0e2ec9e.js" defer></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Shared Library | AS Cloud Docs</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link href="https://common.northwestern.edu/v8/icons/favicon-16.png" rel="icon" sizes="16x16" type="image/png">
    <link href="https://common.northwestern.edu/v8/icons/favicon-32.png" rel="icon" sizes="32x32" type="image/png">
    <meta name="description" content="Docs for Northwestern IT staff on our cloud implementation.">
    
    <link rel="preload" href="/AS-CloudDocs/assets/css/0.styles.425dfd68.css" as="style"><link rel="preload" href="/AS-CloudDocs/assets/js/app.0d6664ed.js" as="script"><link rel="preload" href="/AS-CloudDocs/assets/js/2.ff94c51f.js" as="script"><link rel="preload" href="/AS-CloudDocs/assets/js/15.f6723e1a.js" as="script"><link rel="prefetch" href="/AS-CloudDocs/assets/js/10.3cf140e4.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/11.cddb464c.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/12.11682b41.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/13.285020cb.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/14.a62e8058.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/16.b84263fc.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/17.a712709d.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/18.a87a571c.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/19.1bce5a39.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/20.2e965fc6.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/21.d8eb51fe.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/22.53bf579d.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/23.c3cce089.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/24.a273e29e.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/25.1b3dad6f.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/26.6e816cca.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/27.6a3eefbc.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/28.37de7e53.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/29.1227d9a6.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/3.2f778034.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/30.58fee5a5.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/31.d319880a.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/32.850ac14e.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/33.11bb0ced.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/34.f0a2e74f.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/35.a068a9f7.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/36.967277cf.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/37.66b48363.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/38.295f93a3.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/39.e056013f.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/4.ecf3366a.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/40.b8e85e44.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/41.487f4f04.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/42.71e3bc0d.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/43.bf237910.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/44.6bcae41b.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/45.b91194a9.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/46.04a7c33e.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/5.01c67336.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/6.fdc0b82e.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/7.ad13001f.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/8.971d7637.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/9.2cbae1c0.js">
    <link rel="stylesheet" href="/AS-CloudDocs/assets/css/0.styles.425dfd68.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/AS-CloudDocs/" class="home-link router-link-active"><!----> <span class="site-name">AS Cloud Docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/NIT-Administrative-Systems/AS-CloudDocs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/NIT-Administrative-Systems/AS-CloudDocs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Introduction</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AS-CloudDocs/" aria-current="page" class="sidebar-link">Overview</a></li><li><a href="/AS-CloudDocs/roles-responsibilities.html" class="sidebar-link">Roles &amp; Responsibilities</a></li><li><a href="/AS-CloudDocs/design-for-cloud.html" class="sidebar-link">Designing Apps for the Cloud</a></li><li><a href="/AS-CloudDocs/tools.html" class="sidebar-link">Tool Recommendations</a></li><li><a href="/AS-CloudDocs/docs-site.html" class="sidebar-link">Documentation Site</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Infrastructure</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AS-CloudDocs/infrastructure/aws-account-design.html" class="sidebar-link">AWS Account Structure</a></li><li><a href="/AS-CloudDocs/infrastructure/tagging.html" class="sidebar-link">Tagging Resources</a></li><li><a href="/AS-CloudDocs/infrastructure/vpc-ip-addr.html" class="sidebar-link">VPCs &amp; IP Addressing</a></li><li><a href="/AS-CloudDocs/infrastructure/alb.html" class="sidebar-link">Application Load Balancers</a></li><li><a href="/AS-CloudDocs/infrastructure/certificates.html" class="sidebar-link">Certificates</a></li><li><a href="/AS-CloudDocs/infrastructure/api-gateway.html" class="sidebar-link">API Gateway</a></li><li><a href="/AS-CloudDocs/infrastructure/lambda.html" class="sidebar-link">Lambda</a></li><li><a href="/AS-CloudDocs/infrastructure/ecs-fargate.html" class="sidebar-link">Fargate for ECS</a></li><li><a href="/AS-CloudDocs/infrastructure/ses.html" class="sidebar-link">Simple Email Service (SES)</a></li><li><a href="/AS-CloudDocs/infrastructure/iam.html" class="sidebar-link">Identity &amp; Access Management (IAM)</a></li><li><a href="/AS-CloudDocs/infrastructure/databases.html" class="sidebar-link">Databases</a></li><li><a href="/AS-CloudDocs/infrastructure/secrets.html" class="sidebar-link">Secret Management</a></li><li><a href="/AS-CloudDocs/infrastructure/alerts.html" class="sidebar-link">Alerts</a></li><li><a href="/AS-CloudDocs/infrastructure/cloudfront.html" class="sidebar-link">CloudFront CDN</a></li><li><a href="/AS-CloudDocs/infrastructure/vapor.html" class="sidebar-link">Laravel Vapor</a></li><li><a href="/AS-CloudDocs/infrastructure/aws-service-scheduler.html" class="sidebar-link">AWS Service Scheduler</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Infrastructure as Code</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AS-CloudDocs/iac/terraform-concepts.html" class="sidebar-link">Terraform</a></li><li><a href="/AS-CloudDocs/iac/as-tf-modules.html" class="sidebar-link">AS Terraform Modules</a></li><li><a href="/AS-CloudDocs/iac/example-tf.html" class="sidebar-link">Example Terraform Module</a></li><li><a href="/AS-CloudDocs/iac/available-modules.html" class="sidebar-link">Available Modules</a></li><li><a href="/AS-CloudDocs/iac/state-buckets.html" class="sidebar-link">State Bucket Reference</a></li><li><a href="/AS-CloudDocs/iac/tf-import.html" class="sidebar-link">Terraform Import</a></li><li><a href="/AS-CloudDocs/iac/tf-move.html" class="sidebar-link">Terraform State Move</a></li><li><a href="/AS-CloudDocs/iac/tf-upgrading.html" class="sidebar-link">Upgrading Terraform</a></li><li><a href="/AS-CloudDocs/iac/faq.html" class="sidebar-link">Frequently Asked Questions</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>CI &amp; CD</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AS-CloudDocs/ci-cd/jenkins.html" class="sidebar-link">Jenkins Pipelines</a></li><li><a href="/AS-CloudDocs/ci-cd/shared-libs.html" aria-current="page" class="active sidebar-link">Shared Library</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/AS-CloudDocs/ci-cd/shared-libs.html#usage" class="sidebar-link">Usage</a></li><li class="sidebar-sub-header"><a href="/AS-CloudDocs/ci-cd/shared-libs.html#functions" class="sidebar-link">Functions</a></li></ul></li><li><a href="/AS-CloudDocs/ci-cd/jenkins-ecs-agent.html" class="sidebar-link">Jenkins ECS Agent</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Application Development</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AS-CloudDocs/development/principles.html" class="sidebar-link">Design Principles</a></li><li><a href="/AS-CloudDocs/development/app-patterns.html" class="sidebar-link">Application Patterns</a></li><li><a href="/AS-CloudDocs/development/libraries.html" class="sidebar-link">Packages &amp; Libraries</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>GitHub</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AS-CloudDocs/github/settings-permissions.html" class="sidebar-link">Settings &amp; Permissions</a></li><li><a href="/AS-CloudDocs/github/repo-layout.html" class="sidebar-link">Repository Structure</a></li><li><a href="/AS-CloudDocs/github/workflow.html" class="sidebar-link">Workflow</a></li><li><a href="/AS-CloudDocs/github/policies.html" class="sidebar-link">Policy</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="shared-library"><a href="#shared-library" class="header-anchor">#</a> Shared Library</h1> <p>The <a href="https://github.com/NIT-Administrative-Systems/AS-jenkins-shared" target="_blank" rel="noopener noreferrer">AS-jenkins-shared<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> repository contains common code that can be used in any pipeline.</p> <h2 id="usage"><a href="#usage" class="header-anchor">#</a> Usage</h2> <p>This repository is intended to be used by declarative pipelines.</p> <p>You will need to declare that you are using the library at the top of your pipeline. Jenkins will load the entire lib and make all of its functions available. For example:</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token shebang comment">#!groovy</span>
library identifier<span class="token punctuation">:</span> <span class="token string gstring">&quot;AS-jenkins-shared@stable&quot;</span><span class="token punctuation">,</span> retriever<span class="token punctuation">:</span> <span class="token function">modernSCM</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">$</span><span class="token keyword">class</span><span class="token punctuation">:</span> <span class="token string">'GitSCMSource'</span><span class="token punctuation">,</span> credentialsId<span class="token punctuation">:</span> <span class="token string">'GitHub-awsCloudOpsCJT'</span><span class="token punctuation">,</span> remote<span class="token punctuation">:</span> <span class="token string">'https://github.com/NIT-Administrative-Systems/AS-jenkins-shared.git'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

pipeline <span class="token punctuation">{</span>
    agent any

    stages <span class="token punctuation">{</span>
        stage <span class="token punctuation">(</span><span class="token string">'Terraform'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            sh <span class="token string">'tfenv install &amp;&amp; terraform -version'</span>
            sh <span class="token string">'terraform init -no-color'</span>
            sh <span class="token string">'terraform apply -no-color -auto-approve'</span>
            sh <span class="token string">'terraform output -no-color'</span>
        <span class="token punctuation">}</span>

        stage <span class="token punctuation">(</span><span class="token string">'Publish Secrets to SSM'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                <span class="token comment">// This function is part of our shared library</span>
                <span class="token function">publishSecretsToSSM</span><span class="token punctuation">(</span><span class="token string">'us-east-2'</span><span class="token punctuation">,</span> <span class="token string">'dev/'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div><h2 id="functions"><a href="#functions" class="header-anchor">#</a> Functions</h2> <p>These are the major pieces of shared functionality.</p> <table><thead><tr><th>Function</th> <th>Purpose</th> <th>Requirements</th></tr></thead> <tbody><tr><td><a href="https://github.com/NIT-Administrative-Systems/AS-jenkins-shared/blob/stable/vars/publishSecretsToSSM.groovy" target="_blank" rel="noopener noreferrer"><code>publishSecretsToSSM</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>Implements <a href="/AS-CloudDocs/infrastructure/secrets.html">secret management strategy</a></td> <td>Terraform module has <code>parameters</code> output</td></tr> <tr><td><a href="https://github.com/NIT-Administrative-Systems/AS-jenkins-shared/blob/stable/vars/parseJson.groovy" target="_blank" rel="noopener noreferrer"><code>parseJson</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>Parse JSON &amp; return it in a serializable format</td> <td>None</td></tr> <tr><td><a href="https://github.com/NIT-Administrative-Systems/AS-jenkins-shared/blob/stable/vars/publishSecretsToVapor.groovy" target="_blank" rel="noopener noreferrer"><code>publishSecretsToVapor</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>Implements <a href="/AS-CloudDocs/infrastructure/secrets.html">secret management strategy</a> for Laravel Vapor</td> <td><code>.env.{deploy-env}</code> file has <code>VAPOR_SECRETS=</code> list</td></tr></tbody></table></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/NIT-Administrative-Systems/AS-CloudDocs/edit/stable/ci-cd/shared-libs.md" target="_blank" rel="noopener noreferrer">Edit Page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2/25/2021, 10:14:13 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/AS-CloudDocs/ci-cd/jenkins.html" class="prev">
        Jenkins Pipelines
      </a></span> <span class="next"><a href="/AS-CloudDocs/ci-cd/jenkins-ecs-agent.html">
        Jenkins ECS Agent
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/AS-CloudDocs/assets/js/app.0d6664ed.js" defer></script><script src="/AS-CloudDocs/assets/js/2.ff94c51f.js" defer></script><script src="/AS-CloudDocs/assets/js/15.f6723e1a.js" defer></script>
  </body>
</html>

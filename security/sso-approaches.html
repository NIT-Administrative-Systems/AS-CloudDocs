<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Single Sign-on | AS Cloud Docs</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link href="https://common.northwestern.edu/v8/icons/favicon-16.png" rel="icon" sizes="16x16" type="image/png">
    <link href="https://common.northwestern.edu/v8/icons/favicon-32.png" rel="icon" sizes="32x32" type="image/png">
    <meta name="description" content="Docs for Northwestern IT staff on our cloud implementation.">
    
    <link rel="preload" href="/AS-CloudDocs/assets/css/0.styles.425dfd68.css" as="style"><link rel="preload" href="/AS-CloudDocs/assets/js/app.d4de506f.js" as="script"><link rel="preload" href="/AS-CloudDocs/assets/js/2.1981cd55.js" as="script"><link rel="preload" href="/AS-CloudDocs/assets/js/51.370f3c89.js" as="script"><link rel="prefetch" href="/AS-CloudDocs/assets/js/10.b7cfc97a.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/11.7378bf22.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/12.047b92b2.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/13.70e76045.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/14.ba329726.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/15.b322c67e.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/16.1997f2bd.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/17.a6e8ee7c.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/18.d93e4e1f.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/19.e60f9086.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/20.737bf283.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/21.cb65b659.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/22.8cbb4304.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/23.3e867935.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/24.d5b9e77d.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/25.62d311e1.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/26.b440abaf.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/27.c08e6665.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/28.607e96e3.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/29.16e81cef.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/3.3e038af8.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/30.9c748ad1.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/31.19536c2e.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/32.c9f88a51.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/33.a8e7cf7d.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/34.dd0f5218.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/35.1fe2101b.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/36.cbafddcb.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/37.d85a776b.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/38.143ac759.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/39.a4477bbe.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/4.fd8a9d0a.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/40.9d3b864b.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/41.63da38ab.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/42.fcf0be8c.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/43.35a2833a.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/44.bc138650.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/45.f9131314.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/46.ca5e23a2.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/47.81742c32.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/48.e97407c7.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/49.8b3aa094.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/5.f8165a6e.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/50.64c608db.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/52.28450ca3.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/6.fca2af09.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/7.2bff0867.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/8.f718a08e.js"><link rel="prefetch" href="/AS-CloudDocs/assets/js/9.e11d18ec.js">
    <link rel="stylesheet" href="/AS-CloudDocs/assets/css/0.styles.425dfd68.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/AS-CloudDocs/" class="home-link router-link-active"><!----> <span class="site-name">AS Cloud Docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/NIT-Administrative-Systems/AS-CloudDocs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/NIT-Administrative-Systems/AS-CloudDocs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Introduction</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AS-CloudDocs/" aria-current="page" class="sidebar-link">Overview</a></li><li><a href="/AS-CloudDocs/roles-responsibilities.html" class="sidebar-link">Roles &amp; Responsibilities</a></li><li><a href="/AS-CloudDocs/design-for-cloud.html" class="sidebar-link">Designing Apps for the Cloud</a></li><li><a href="/AS-CloudDocs/tools.html" class="sidebar-link">Tool Recommendations</a></li><li><a href="/AS-CloudDocs/docs-site.html" class="sidebar-link">Documentation Site</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Infrastructure</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AS-CloudDocs/infrastructure/aws-account-design.html" class="sidebar-link">AWS Account Structure</a></li><li><a href="/AS-CloudDocs/infrastructure/tagging.html" class="sidebar-link">Tagging Resources</a></li><li><a href="/AS-CloudDocs/infrastructure/vpc-ip-addr.html" class="sidebar-link">VPCs &amp; IP Addressing</a></li><li><a href="/AS-CloudDocs/infrastructure/alb.html" class="sidebar-link">Application Load Balancers</a></li><li><a href="/AS-CloudDocs/infrastructure/certificates.html" class="sidebar-link">Certificates</a></li><li><a href="/AS-CloudDocs/infrastructure/api-gateway.html" class="sidebar-link">API Gateway</a></li><li><a href="/AS-CloudDocs/infrastructure/lambda.html" class="sidebar-link">Lambda</a></li><li><a href="/AS-CloudDocs/infrastructure/ecs-fargate.html" class="sidebar-link">Fargate for ECS</a></li><li><a href="/AS-CloudDocs/infrastructure/ses.html" class="sidebar-link">Simple Email Service (SES)</a></li><li><a href="/AS-CloudDocs/infrastructure/iam.html" class="sidebar-link">Identity &amp; Access Management (IAM)</a></li><li><a href="/AS-CloudDocs/infrastructure/databases.html" class="sidebar-link">Databases</a></li><li><a href="/AS-CloudDocs/infrastructure/secrets.html" class="sidebar-link">Secret Management</a></li><li><a href="/AS-CloudDocs/infrastructure/alerts.html" class="sidebar-link">Alerts</a></li><li><a href="/AS-CloudDocs/infrastructure/cloudfront.html" class="sidebar-link">CloudFront CDN</a></li><li><a href="/AS-CloudDocs/infrastructure/vapor.html" class="sidebar-link">Laravel Vapor</a></li><li><a href="/AS-CloudDocs/infrastructure/aws-service-scheduler.html" class="sidebar-link">AWS Service Scheduler</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Infrastructure as Code</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AS-CloudDocs/iac/terraform-concepts.html" class="sidebar-link">Terraform</a></li><li><a href="/AS-CloudDocs/iac/as-tf-modules.html" class="sidebar-link">AS Terraform Modules</a></li><li><a href="/AS-CloudDocs/iac/example-tf.html" class="sidebar-link">Example Terraform Module</a></li><li><a href="/AS-CloudDocs/iac/available-modules.html" class="sidebar-link">Available Modules</a></li><li><a href="/AS-CloudDocs/iac/state-buckets.html" class="sidebar-link">State Bucket Reference</a></li><li><a href="/AS-CloudDocs/iac/tf-import.html" class="sidebar-link">Terraform Import</a></li><li><a href="/AS-CloudDocs/iac/tf-move.html" class="sidebar-link">Terraform State Move</a></li><li><a href="/AS-CloudDocs/iac/tf-upgrading.html" class="sidebar-link">Upgrading Terraform</a></li><li><a href="/AS-CloudDocs/iac/faq.html" class="sidebar-link">Frequently Asked Questions</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>CI &amp; CD</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AS-CloudDocs/ci-cd/jenkins.html" class="sidebar-link">Jenkins Pipelines</a></li><li><a href="/AS-CloudDocs/ci-cd/shared-libs.html" class="sidebar-link">Shared Library</a></li><li><a href="/AS-CloudDocs/ci-cd/jenkins-ecs-agent.html" class="sidebar-link">Jenkins ECS Agent</a></li><li><a href="/AS-CloudDocs/ci-cd/gha.html" class="sidebar-link">GitHub Actions</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Application Development</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AS-CloudDocs/development/principles.html" class="sidebar-link">Design Principles</a></li><li><a href="/AS-CloudDocs/development/app-patterns.html" class="sidebar-link">Application Patterns</a></li><li><a href="/AS-CloudDocs/development/laravel-stack.html" class="sidebar-link">Laravel Stack</a></li><li><a href="/AS-CloudDocs/development/express-stack.html" class="sidebar-link">ExpressJS Stack</a></li><li><a href="/AS-CloudDocs/development/spring-stack.html" class="sidebar-link">Spring Stack</a></li><li><a href="/AS-CloudDocs/development/frontend-stacks.html" class="sidebar-link">Frontend Stacks</a></li><li><a href="/AS-CloudDocs/development/libraries.html" class="sidebar-link">Packages &amp; Libraries</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Security</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AS-CloudDocs/security/sso-approaches.html" aria-current="page" class="active sidebar-link">Single Sign-on</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/AS-CloudDocs/security/sso-approaches.html#openam-integration" class="sidebar-link">OpenAM Integration</a></li><li class="sidebar-sub-header"><a href="/AS-CloudDocs/security/sso-approaches.html#federation-shibboleth" class="sidebar-link">Federation/Shibboleth</a></li><li class="sidebar-sub-header"><a href="/AS-CloudDocs/security/sso-approaches.html#azure-activedirectory" class="sidebar-link">Azure ActiveDirectory</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>GitHub</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AS-CloudDocs/github/settings-permissions.html" class="sidebar-link">Settings &amp; Permissions</a></li><li><a href="/AS-CloudDocs/github/repo-layout.html" class="sidebar-link">Repository Structure</a></li><li><a href="/AS-CloudDocs/github/workflow.html" class="sidebar-link">Workflow</a></li><li><a href="/AS-CloudDocs/github/policies.html" class="sidebar-link">Policy</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="single-sign-on"><a href="#single-sign-on" class="header-anchor">#</a> Single Sign-on</h1> <p>There are several different options available for AS to do single-sign on.</p> <table><thead><tr><th>Type</th> <th>Typical Use Cases</th> <th>Technology</th></tr></thead> <tbody><tr><td>OpenAM Integration</td> <td>Agentless SSO, Agent SSO</td> <td>OpenID/OAuth2 or OpenAM's REST APIs</td></tr> <tr><td>Federation/Shibboleth</td> <td>Vendor app login</td> <td>SAML</td></tr> <tr><td>Azure AD</td> <td>General purpose</td> <td>OpenID/OAuth2 or SAML</td></tr></tbody></table> <p>All of these options support multi-factor (MFA) authentication. MFA must be enabled for all applications as per the Admin Systems Expectations given over the last few years.</p> <div class="custom-block tip"><p class="custom-block-title">Recommendations</p> <p>Our general recommendation is to use <a href="#applications-via-openid-connect">Azure AD's OpenID authentication</a>. This is our most secure option, and it utilizes the standard OpenID protocol.</p> <p>This is a relatively new approach for AS; we have made heavy use of the OpenAM integrations. Our understanding and practices around AzureAD OpenID are developing.</p></div> <h2 id="openam-integration"><a href="#openam-integration" class="header-anchor">#</a> OpenAM Integration</h2> <p>This is the traditional &quot;online passport&quot; login screen that Northwestern has used for years.</p> <p>There are two methods of doing an OpenAM integration: agentless SSO, which utilizes the <code>nusso</code> session cookie, or OAuth2. The web agent that Identity Services/Cyberinfrastructure provide for webservers like Apache and IIS utilizes OAuth2.</p> <h3 id="agentless"><a href="#agentless" class="header-anchor">#</a> Agentless</h3> <p>Agentless SSO utilizes the <code>nusso</code> session cookie set for the <code>.northwestern.edu</code> domain. This cookie is <code>httpOnly</code> &amp; <code>secure</code>, meaning that an application must meet all of the following criteria to access the cookie:</p> <ul><li>Served from a northwestern.edu name</li> <li>Served over HTTPS</li> <li>Has a backend that can access the cookie (client-side JavaScript cannot read the value of an <code>httpOnly</code> cookie)</li></ul> <p>The session token can be looked up using <a href="https://apiserviceregistry.northwestern.edu/apis/identity-management-apis/IdentityManagement-AgentlessWebSSO.html" target="_blank" rel="noopener noreferrer">the Agentless SSO API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and resolved to a netID. Depending on the authentication tree you use, you can trigger Duo MFA. The API endpoint will indicate whether an <code>nusso</code> session token has gone through MFA.</p> <p>This is largely self-service. Requests for access to the Agentless SSO API are made in the API Service Registry and still must be reviewed and approved. This is not a standard authentication protocol, so you will need to develop it in your application or use one of our <a href="/AS-CloudDocs/development/libraries.html">agentless libraries</a>.</p> <h3 id="web-agent"><a href="#web-agent" class="header-anchor">#</a> Web Agent</h3> <p>The web agent comes in two flavours: the Apache agent for use on Linux, and the IIS agent for use on Windows Server. This is a package that Identity Services provides to CI that includes a config file that's been pre-configured with an OAuth2 client ID &amp; secret.</p> <p>If you want to use a web agent, you will need to submit a ticket to Identity Services asking them to set up a new application and provide the appropriate agent package for your webserver.</p> <p>The web agent cannot be used with any serverless services on AWS. It could potentially be used with ECS Fargate, but we do not have any example Dockerfiles at this time.</p> <h2 id="federation-shibboleth"><a href="#federation-shibboleth" class="header-anchor">#</a> Federation/Shibboleth</h2> <p>Federation (colloquially known as &quot;fed&quot; or &quot;shibb&quot;) is a SAML identity provider (IdP). SAML is a standard that many enterprise SaaS service providers can work with.</p> <p>To set up a SAML integration, you will need to get the service provider's SAML metadata and open a ticket to the Identity Services team. They will do the necessary configuration and provide you with the IdP's SAML metadata. Then, you can configure the SAML authentication on the SaaS app side.</p> <h2 id="azure-activedirectory"><a href="#azure-activedirectory" class="header-anchor">#</a> Azure ActiveDirectory</h2> <p>Azure ActiveDirectory (Azure AD) is Microsoft's cloud identity solution. Cyberinfrastructure's Collaboration Services have replicated all of our identities to Azure AD, it can be used in a similar fashion to OpenAM.</p> <p>As an added bonus, authenticating to Azure AD yields an access token that can call the <a href="https://docs.microsoft.com/en-us/graph/use-the-api" target="_blank" rel="noopener noreferrer">Microsoft Graph API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. This can be used to load the user's profile picture &amp; detailed contact information. If additional scopes are set up and the user consents, it can be used to integrate with their Outlook calendar or other O365 services.</p> <h3 id="applications-via-openid-connect"><a href="#applications-via-openid-connect" class="header-anchor">#</a> Applications via OpenID Connect</h3> <p>To use Azure AD's OpenID authentication, your application must be served via HTTPS, with an exception given for <code>localhost</code>.</p> <p>You can <a href="https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview" target="_blank" rel="noopener noreferrer">log in to the Azure console<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and register an application to begin using OpenID authentication from the <em>App registrations</em> screen.</p> <p>You will need to configure your application's redirect URIs on its <em>Authentication</em> screen, create a secret on its <em>Certificates &amp; secrets</em> screen, and get the client ID from the <em>Overview</em> screen.</p> <p>Since OpenID connect is a standard protocol built on OAuth2, your development framework is likely to have a plugin that supports it. For Laravel, the <a href="https://nit-administrative-systems.github.io/SysDev-laravel-soa/" target="_blank" rel="noopener noreferrer"><code>laravel-soa</code> package<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> includes a Socialite driver that will work with Northwestern's Azure AD tenant out of the box.</p> <p>If you cannot find an existing integration library or plugin, review <a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-protocols-oidc" target="_blank" rel="noopener noreferrer">Microsoft's OpenID documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> on how to implement the authentication flow.</p> <p>When possible, you should configure applications with an additional parameter for the authorization redirect: <code>domain_hint=northwestern.edu</code>. This will skip the initial &quot;enter your microsoft account&quot; screen and sends the user directly to the Online Passport netID login screen.</p> <div class="custom-block warning"><p class="custom-block-title">Secret Management</p> <p>For web applications, the proper OpenID auth flow requires calling the <code>/tokens</code> endpoint and using a client secret.</p> <p>The client secret expires after a set period of time. Azure will <strong>not</strong> notify users when their secrets are about to expire, so please make a note of this expiration and migrate to a new secret before an old one expires.</p> <p>Single-page apps, mobile apps, and certain other applications use other flows that do not require this secret. Please choose an appropriate flow for your type of application.</p></div> <p>To enable Duo MFA, you must submit a ticket to the Cyberinfrastructure Collab Services team. MFA can only be enabled by Azure tenant administrators, and its enabled/disabled status is not reflected in your application's configuration dashboard.</p> <h4 id="openid-with-an-alb"><a href="#openid-with-an-alb" class="header-anchor">#</a> OpenID with an ALB</h4> <p>If your app is using an ALB, you can configure a listener rule that will handle OpenID authentication for all requests, before the request is passed to your app:</p> <div class="language-hcl extra-class"><pre class="language-hcl"><code><span class="token keyword">resource <span class="token type variable">&quot;aws_lb_listener&quot;</span></span> <span class="token string">&quot;front_end&quot;</span> <span class="token punctuation">{</span>
  <span class="token property">load_balancer_arn</span> <span class="token punctuation">=</span> aws_lb.front_end.arn

  <span class="token comment"># . . . other config</span>

  <span class="token keyword">default_action</span> <span class="token punctuation">{</span>
    <span class="token property">type</span> <span class="token punctuation">=</span> <span class="token string">&quot;authenticate-oidc&quot;</span>

    <span class="token keyword">authenticate_oidc</span> <span class="token punctuation">{</span>
      <span class="token property">client_id</span>              <span class="token punctuation">=</span> <span class="token string">&quot;your-client-id-here&quot;</span>
      <span class="token property">client_secret</span>          <span class="token punctuation">=</span> <span class="token string">&quot;your-client-secret-here&quot;</span>
      <span class="token property">authorization_endpoint</span> <span class="token punctuation">=</span> <span class="token string">&quot;https://login.microsoftonline.com/northwestern.edu/oauth2/v2.0/authorize&quot;</span>
      <span class="token property">token_endpoint</span>         <span class="token punctuation">=</span> <span class="token string">&quot;https://login.microsoftonline.com/northwestern.edu/oauth2/v2.0/token&quot;</span>
      <span class="token property">issuer</span>                 <span class="token punctuation">=</span> <span class="token string">&quot;https://login.microsoftonline.com/7d76d361-8277-4708-a477-64e8366cd1bc/v2.0&quot;</span>
      <span class="token property">user_info_endpoint</span>     <span class="token punctuation">=</span> <span class="token string">&quot;https://graph.microsoft.com/oidc/userinfo&quot;</span>

      <span class="token property">authentication_request_extra_params</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
          <span class="token property">domain_hint</span> <span class="token punctuation">=</span> <span class="token string">&quot;northwestern.edu&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment"># . . . other actions</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The redirect URI for the load balancer's OpenID provider is <code>https://&lt;your-app-hostname&gt;/oauth2/idpresponse</code>. Add this to the list of redirect URIs in the Azure AD console.</p> <p>The forwarded request will include <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/listener-authenticate-users.html#user-claims-encoding" target="_blank" rel="noopener noreferrer">some additional headers with auth information<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. To obtain the netID from this, you will need to parse the JWT and pull out the <code>userPrincipalName</code> claim.</p> <p>When using this approach, you should give consideration to how you will authenticate to your app when running it on your development machine.</p> <h3 id="enterprise-applications-via-saml"><a href="#enterprise-applications-via-saml" class="header-anchor">#</a> Enterprise Applications via SAML</h3> <p>Azure AD has another class of application: enterprise applications. Azure AD will serve as a SAML IdP, similar to federation.</p> <p>To get started with this, you must submit a ticket to Cyberinfrastructure's Collab Services group. They must do the Azure AD-side configuration. It should otherwise be similar to <a href="#federation-shibboleth">setting up federation</a>.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/NIT-Administrative-Systems/AS-CloudDocs/edit/stable/security/sso-approaches.md" target="_blank" rel="noopener noreferrer">Edit Page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/22/2022, 2:41:33 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/AS-CloudDocs/development/libraries.html" class="prev">
        Packages &amp; Libraries
      </a></span> <span class="next"><a href="/AS-CloudDocs/github/settings-permissions.html">
        Settings &amp; Permissions
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/AS-CloudDocs/assets/js/app.d4de506f.js" defer></script><script src="/AS-CloudDocs/assets/js/2.1981cd55.js" defer></script><script src="/AS-CloudDocs/assets/js/51.370f3c89.js" defer></script>
  </body>
</html>
